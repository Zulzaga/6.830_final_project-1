package minidb;

import java.util.Iterator;

/**
 * This class represents range scan on a specified Column object.
 * 
 * To create a RangeScan, we need to pass in a Column object,
 * low value, high value, and type of range:
 * <, <=, >, >=, <<, <=<, <<=, <=<=
 * @author danamukusheva
 *
 */
public class RangeScan {
	
	private Column column;
	private Iterator<Integer> childIterator;
	
	private Integer low; //Can be null
	private Integer high; //Can be null
	private String range;
	private boolean singleRange; // True if range is <, >, <= or >=
	
	public RangeScan(Column col, Integer low, Integer high, String range) throws Exception{
		this.range = range;
		this.low = low;
		this.high = high;
		
		this.checkRangeEnds());	
		this.column = col;
		this.childIterator = col.getIterator();	

	}
	
	/**
	 * Check if low and high value of the range can be used with a specified range
	 * @throws Exception
	 */
	private void checkRangeEnds() throws Exception{
		if (low == null && high == null){
			throw new Exception("RangeScan cannot be instantiated: low and high values are both null!");
		}
		
		if (low != null && high != null){
			this.singleRange = false;
		}
		else{
			this.singleRange = true;
		}
		
		if (this.range.length()==3 && this.singleRange){
			throw new Exception("RangeScan cannot be instantiated:low and high should be both non-null!");
		}
		if (this.range.length()==1 && !this.singleRange){
			throw new Exception("RangeScan cannot be instantiated: either low or high should null!");
		}
	}

}
